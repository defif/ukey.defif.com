(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2e2cd35c"],{"264d":function(t,e,a){"use strict";a.r(e);var s=(a("99af"),a("a434"),a("d3b7"),a("ac1f"),a("25f0"),a("466d"),a("b85c")),n=(a("96cf"),a("1da1")),r=a("c947"),o=a("2af7"),i=a("c9c7"),c=a.n(i),d=a("90f7"),l=a.n(d),u={name:"Send",mixins:[a("26ca").a],data:function(){var t=this;return{d_error:!1,d_errorReason:"",d_media:0,d_alarm:0,d_zoom:5,d_safeLow:"5",d_average:"8",d_fast:"13",d_fastest:"20",d_transactionHash:"0x21e40e3aa5727f918159018b329f141b75100719079cfaf2e8a095f9a112a8c0",d_snackbar:!1,d_gasLimit:"88888",d_utxoList:[{nonce:"0",amount:"",address:""}],d_maxPaidIndex:0,UnitHelper:c.a,d_clickAll:!1,d_extraFee:0,d_signHash:"",d_bordercastShow:!1,d_txOut:[{address:"",amount:0}],d_addressRules:[function(e){return l.a.test(e,"eth")||t.$t("Invalid address")}],d_amountRules:[function(e){return/^[+]{0,1}[1-9]\d*$|^[+]{0,1}(0\.\d*[1-9])$|^[+]{0,1}([1-9]\d*\.\d*[0-9])$/.test(e)||t.$t("Invalid amount")}],d_feeHelpList:{}}},computed:{c_totalAmounts:function(){return this.d_txOut.length>0?c()(this.d_txOut[0].amount,"eth_wei"):c()(0)},c_utxoTotal:function(){return this.d_utxoList.length>0?c()(this.d_utxoList[0].amount):c()(0)},c_totalFees:function(){var t=c()(this.d_zoom).times(this.d_gasLimit);return c()(t,"gwei_wei")},c_xpub:function(t){return t.$store.__s("usb.xpub")},c_coinInfo:function(t){return t.$store.__s("coinInfo")},c_coinProtocol:function(t){return t.$store.__s("coinProtocol")},c_pageLoading:function(t){return t.$store.__s("pageLoading")},c_usb:function(t){return t.$store.__s("usb")},trop:function(t){return t.$store.__s("trop")}},created:function(){var t=this;this.$nextTick((function(){t.setDefaultGasLimit(),t.getUtxoList(),t.getFeeRate()}))},methods:{setDefaultGasLimit:function(){var t=this.d_txOut.length;this.d_gasLimit=t>3?c()(t).minus(3).times(6e4).plus(88888).toString(10):"88888"},zoomOut:function(){this.d_zoom=this.d_safeLow},zoomIn:function(){this.d_zoom=this.d_fastest},showAllIcon:function(){this.d_clickAll=!1},sendAllBalance:function(){this.d_txOut[0].amount=c()(this.trop.balance).div(1e6).toString(10),0!==this.c_utxoTotal.toNumber()?this.d_clickAll=!0:this.$message.error(this.$t("Balance is empty!"))},getFeeRate:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.b.GetRecommendFee("eth");case 2:if((a=e.sent).safeLow){e.next=5;break}return e.abrupt("return");case 5:t.d_safeLow=Math.floor(a.safeLow/10),t.d_average=Math.floor(a.average/10),t.d_fast=Math.floor(a.fast/10),t.d_fastest=Math.floor(a.fastest/10),t.d_zoom=parseInt(t.d_average);case 10:case"end":return e.stop()}}),e)})))()},getUtxoList:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.ethGetAddress();case 2:return a=e.sent,e.next=5,r.b.BalanceByAddress({coinName:"trop",address:a});case 5:(s=e.sent).balance?t.d_utxoList.splice(0,1,{amount:(null==s?void 0:s.balance)?null==s?void 0:s.balance:0,address:null==s?void 0:s.address,nonce:s.nonce}):t.$message.info(s.error);case 7:case"end":return e.stop()}}),e)})))()},updateNonce:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.$store.__s("pageLoading",!0),t.d_error=!1,t.d_bordercastShow=!1,e.next=5,t.getUtxoList();case 5:t.$store.__s("pageLoading",!1),t.$message.success(t.$t("Update nonce successfully!"));case 7:case"end":return e.stop()}}),e)})))()},checkTxOutRules:function(){for(var t=/^[+]{0,1}[1-9]\d*$|^[+]{0,1}(0\.\d*[1-9])$|^[+]{0,1}([1-9]\d*\.\d*[0-9])$/,e=this.d_txOut.length,a=0;a<e;a++){var s=this.d_txOut[a];if(!t.test(s.amount)||!s.amount)return this.$message.error(this.$t("Please enter a valid quantity")),!1;if(!l.a.test(s.address,"eth"))return this.$message.error(this.$t("Please enter a valid Address")),!1}return!0},checkBalance:function(){return!c()(this.d_txOut[0].amount).times(1e6).gt(this.trop.balance)||(this.$message.error(this.$t("Your USDT account balance is insufficient!")),!1)},errorBroadcast:function(t){this.d_error=!0,this.d_errorReason=t},closeBordercast:function(t,e){"auto"===t&&(this.d_snackbar=!0,this.d_transactionHash=e),this.d_bordercastShow=!1,this.d_txOut[0].amount=0},getMaxPaidIndex:function(){this.d_maxPaidIndex=0},delTxOut:function(t){1!==this.d_txOut.length?this.d_txOut.splice(t,1):this.$message.warning(this.$t("The last one can't be delete!"))},paste:function(t){return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.readText();case 2:t.address=e.sent;case 3:case"end":return e.stop()}}),e)})))()},getAddressN:function(t){var e,a=[],n=t.match(/\/[0-9]+('|H)?/g),r=Object(s.a)(n);try{for(r.s();!(e=r.n()).done;){var o=e.value,i=parseInt(o.match(/[0-9]+/g)[0]);o.match(/('|H)/g)&&(i=(2147483648|i)>>>0),a.push(i)}}catch(t){r.e(t)}finally{r.f()}return a},checkAndSend:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.$store.__s("pageLoading",!0),t.checkTxOutRules()){e.next=4;break}return t.$store.__s("pageLoading",!1),e.abrupt("return");case 4:if(t.checkBalance()){e.next=7;break}return t.$store.__s("pageLoading",!1),e.abrupt("return");case 7:return e.prev=7,t.getUtxoList(),e.next=11,t.signTx();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(7),t.$message.error(t.$t("Unknown Error!"));case 16:t.$store.__s("pageLoading",!1);case 17:case"end":return e.stop()}}),e,null,[[7,13]])})))()},signTx:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var a,s,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={bip32_path:"m/44'/".concat(t.c_coinInfo.slip44,"'/0'/0/").concat(t.trop.account),erc20:t.c_coinInfo.testContract,nonce:t.d_utxoList[0].nonce,gas_price:c()(1,"gwei_wei").times(t.d_zoom).toString(10),gas_limit:t.d_gasLimit,to:t.d_txOut[0].address,chain_id:3,value:c()(t.d_txOut[0].amount).times(1e6).toString(10)},e.next=3,t.$usb.signETH(s);case 3:(null==(n=e.sent)||null===(a=n.data)||void 0===a?void 0:a.raw)?(r=n.data.raw,t.d_signHash=r,t.d_bordercastShow=!0):t.$message.error(t.$t("Transaction signature failed!"));case 5:case"end":return e.stop()}}),e)})))()}},watch:{d_txOut:{handler:function(){this.getMaxPaidIndex()},deep:!0}},i18n:{messages:{zhCN:{"Ethereum address does not have sufficient balance!":"以太坊地址没有足够的余额","Your USDT account balance is insufficient!":"你的USDT账户余额不足","Balance is empty!":"账户余额为空","Transaction Fee":"交易手续费","All Balances":"发送所有余额","Transaction signature failed":"签名交易失败","Transaction signature success":"签名交易成功","Please enter a valid Address":"请输入有效的地址","The network breakdown!":"网络异常","Please enter a valid quantity":"请输入有效的金额","The available balance is insufficient for payment!":"可用余额不够支付,可能导致签名失败","The amount or address you entered is invalid!":"你输入的金额或者地址无效","If the payment is too fragmentary, additional 0.0001 currency handling fee will be paid":"过于零碎的支付，额外支付0.0001币种手续费",Address:"接收地址",Amount:"发送金额",Delete:"删除",Paste:"粘贴",Most:"最多","Add recipient":"添加接收者","Check and send":"检查并发送","Are you sure to delete?":"你确定要删除吗?",Yes:"是",No:"否","Invalid address":"地址无效","Invalid amount":"金额无效","Invalid fee":"费率无效","Please input address":"请输入地址","Please input amount":"请输入金额",high:"高",middle:"中",low:"低",Amounts:"发送总额",Fees:"手续费",Total:"合计",Fee:"费率",Review:"核对","Unknown Error!":"未知错误","TX Hash":"交易哈希"}}}},b=(a("eb17"),a("2877")),f=a("6544"),_=a.n(f),p=a("8336"),m=a("b0af"),h=a("cc20"),x=a("62ad"),v=a("a523"),g=a("132d"),w=a("0fd9"),k=a("ba0d"),$=a("8654"),y=a("3a2f"),C=Object(b.a)(u,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{staticClass:"pa-0 send-wrap",attrs:{fluid:""}},[a("broadcast-dialog",{attrs:{show:t.d_bordercastShow,signHash:t.d_signHash},on:{"close-dialog":t.closeBordercast,"error-broadcast":t.errorBroadcast}}),a("broadcast-success",{attrs:{show:t.d_snackbar,transactionHash:t.d_transactionHash,coinType:t.c_coinInfo.symbol},on:{close:function(e){t.d_snackbar=!1}}}),a("broadcast-error",{attrs:{show:t.d_error,reason:this.d_errorReason},on:{"update-nonce":t.updateNonce,close:function(e){t.d_error=!1}}}),a("v-card",{staticClass:"pa-3"},[a("div",{staticClass:"table"},[a("div",{staticClass:"table-header px-3 app-secondary-bg"},[a("div",{staticClass:"table-c address-c subtitle-2"},[t._v(t._s(t.$t("Address")))]),a("div",{staticClass:"table-c amount-c subtitle-2"},[t._v(t._s(t.$t("Amount")))]),a("div",{staticClass:"table-c action-c subtitle-2"},[t._v(t._s(t.$t("Delete")))])]),a("div",{staticClass:"table-body"},t._l(t.d_txOut,(function(e,s){return a("div",{key:s,staticClass:"table-r px-3"},[a("div",{staticClass:"table-c address-c subtitle-2"},[a("v-text-field",{attrs:{rules:t.d_addressRules,label:t.$t("Address"),hint:t.$t("Please input address")},model:{value:e.address,callback:function(a){t.$set(e,"address",a)},expression:"item.address"}},[a("v-tooltip",{attrs:{slot:"append",top:""},slot:"append",scopedSlots:t._u([{key:"activator",fn:function(s){var n=s.on;return[a("v-icon",t._g({attrs:{color:"primary",size:"16"},on:{click:function(a){return t.paste(e)}}},n),[t._v("mdi-content-paste")])]}}],null,!0)},[a("span",{staticClass:"subtitle-2"},[t._v(t._s(t.$t("Paste")))])])],1)],1),a("div",{staticClass:"table-c amount-c"},[a("v-text-field",{attrs:{rules:t.d_amountRules,label:t.$t("Amount"),hint:t.$t("Please input amount")},on:{input:t.showAllIcon},model:{value:e.amount,callback:function(a){t.$set(e,"amount",a)},expression:"item.amount"}},[a("div",{staticClass:"primary--text",attrs:{slot:"append"},slot:"append"},[t._v(t._s(t.c_coinInfo.symbol.toUpperCase()))])]),t.d_clickAll?t._e():a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-icon",t._g({staticClass:"ml-4",on:{click:function(e){return t.sendAllBalance(s)}}},n),[t._v("mdi-publish")])]}}],null,!0)},[a("span",[t._v(t._s(t.$t("All Balances")))])])],1),a("div",{staticClass:"table-c action-c"},[a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-icon",t._g({staticClass:"close-icon",attrs:{disabled:t.d_txOut.length<=1},on:{click:function(e){return t.delTxOut(s)}}},n),[t._v("mdi-close")])]}}],null,!0)},[a("span",[t._v(t._s(t.$t("Delete")))])])],1)])})),0)]),a("div",{staticClass:"form"},[a("div",{staticClass:"d-flex flex-column justify-start align-start pl-2"},[a("div",{staticClass:"subtitle-2",class:t.c_utxoTotal.toString(10)?"primary--text":"red--text"},[t._v("ERC20 Testnet "+t._s(t.$t("Available Balance"))+"："+t._s(t.UnitHelper(t.c_utxoTotal,"wei_eth").toString(10))+" TROP")]),a("div",{staticClass:"subtitle-2",class:t.trop.balance.toString(10)?"primary--text":"red--text"},[t._v(" TUSDT "+t._s(t.$t("Available Balance"))+"："+t._s(t.UnitHelper(t.trop.balance).div(1e6).toString(10))+" TUSDT ")]),a("div",{staticClass:"subtitle-2"},[t._v("nonce:"+t._s(t.d_utxoList[0].nonce?t.d_utxoList[0].nonce:t.$t("Requesting the latest nonce...")))])]),a("div",{staticClass:"right body-2"},[a("v-chip",{staticClass:"chip body-2",attrs:{outlined:""}},[t._v(t._s(t.$t("Amounts"))+" "+t._s(t.UnitHelper(t.c_totalAmounts,"wei_eth").toString(10))+" "+t._s(t.c_coinInfo.symbol.toUpperCase()))]),a("v-chip",{staticClass:"chip body-2",attrs:{outlined:""}},[t._v(t._s(t.$t("Fees"))+" "+t._s(t.UnitHelper(t.c_totalFees,"wei_eth").toString(10))+" TROP ")]),a("v-chip",{staticClass:"chip",attrs:{outlined:"",color:"primary"}},[t._v(t._s(t.$t("Total"))+" "+t._s(t.d_txOut[0].amount)+" TUSDT + "+t._s(t.UnitHelper(t.c_totalFees,"wei_eth").toString(10))+" TROP")])],1)]),a("div",{staticClass:"d-flex flex-row justify-end align-center"},[a("v-row",[a("v-col",{attrs:{cols:"9"}},[a("div",{staticClass:"subtitle-2 text-left mb-4"},[t._v(t._s(t.$t("Transaction Fee")))]),a("v-slider",{attrs:{"thumb-label":"",ticks:"always","persistent-hint":"",max:t.d_fastest,min:t.d_safeLow},scopedSlots:t._u([{key:"prepend",fn:function(){return[a("span",{staticClass:"subtitle-2",on:{click:t.zoomOut}},[t._v(t._s(t.$t("Low")))])]},proxy:!0},{key:"append",fn:function(){return[a("span",{staticClass:"subtitle-2",on:{click:t.zoomIn}},[t._v(t._s(t.$t("High")))])]},proxy:!0}]),model:{value:t.d_zoom,callback:function(e){t.d_zoom=e},expression:"d_zoom"}})],1),a("v-col",{staticClass:"text-sm-right pa-0 mt-3",attrs:{cols:"3"}},[a("v-btn",{attrs:{color:"success",rounded:""},on:{click:function(e){return t.checkAndSend()}}},[t._v(t._s(t.$t("Check and send")))])],1)],1)],1)])],1)}),[],!1,null,"6b39380d",null);e.default=C.exports,_()(C,{VBtn:p.a,VCard:m.a,VChip:h.a,VCol:x.a,VContainer:v.a,VIcon:g.a,VRow:w.a,VSlider:k.a,VTextField:$.a,VTooltip:y.a})},b66c:function(t,e,a){(e=a("24fb")(!1)).push([t.i,".send-wrap[data-v-6b39380d]{max-width:960px;margin:20px auto}.table[data-v-6b39380d]{margin-bottom:12px;border:1px solid rgba(44,115,210,.6)}.table .table-header[data-v-6b39380d]{text-transform:capitalize}.table .table-r[data-v-6b39380d]{font-size:14px}.table .table-header[data-v-6b39380d],.table .table-r[data-v-6b39380d]{min-height:80px;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;border-bottom:1px solid rgba(0,0,0,.12)}.table .table-header[data-v-6b39380d],.table .table-header .table-c[data-v-6b39380d],.table .table-r[data-v-6b39380d],.table .table-r .table-c[data-v-6b39380d]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.table .table-header .table-c[data-v-6b39380d],.table .table-r .table-c[data-v-6b39380d]{position:relative;padding:0 10px;color:#fff}.table .table-header .table-c.action-c[data-v-6b39380d],.table .table-r .table-c.action-c[data-v-6b39380d]{width:120px;cursor:pointer;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.table .table-header .table-c.address-c[data-v-6b39380d],.table .table-r .table-c.address-c[data-v-6b39380d]{-webkit-box-flex:3;-ms-flex:3;flex:3}.table .table-header .table-c.amount-c[data-v-6b39380d],.table .table-r .table-c.amount-c[data-v-6b39380d]{-webkit-box-flex:1;-ms-flex:1;flex:1;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;cursor:pointer}.table .close-icon[data-v-6b39380d]{cursor:pointer}.table .close-icon[data-v-6b39380d]:hover{color:#ef5350}.table .table-r[data-v-6b39380d]:hover{background-color:#e3f2fd}.form[data-v-6b39380d]{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding:10px 0}.form[data-v-6b39380d],.form .right[data-v-6b39380d]{display:-webkit-box;display:-ms-flexbox;display:flex}.form .right[data-v-6b39380d]{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end;-webkit-box-flex:1;-ms-flex:1;flex:1}.form .right .chip[data-v-6b39380d]{margin-bottom:5px;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;max-width:-webkit-fit-content;max-width:-moz-fit-content;max-width:fit-content}",""]),t.exports=e},de6b:function(t,e,a){var s=a("b66c");"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals),(0,a("499e").default)("16ea9a33",s,!0,{sourceMap:!1,shadowMode:!1})},eb17:function(t,e,a){"use strict";var s=a("de6b");a.n(s).a}}]);